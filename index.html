<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Expense Tracker</title>

  <!-- ‚úÖ Firebase SDK via CDN -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>

  <style>
    body {
      font-family: sans-serif;
      max-width: 500px;
      margin: auto;
      padding: 2rem;
    }
    input, button {
      display: block;
      margin: 10px 0;
      width: 100%;
      padding: 10px;
      font-size: 16px;
    }
    .record {
      border-bottom: 1px solid #ccc;
      padding: 10px 0;
    }
    .record strong {
      font-size: 18px;
    }
    h2, h3 {
      margin-top: 1.5rem;
    }
  </style>
</head>
<body>
  <h2>üìã ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</h2>
  <input id="amount" type="number" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)" />
  <input id="category" type="text" placeholder="‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏≤‡∏´‡∏≤‡∏£" />
  <button onclick="addExpense()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>

  <h3>üìå ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
  <div id="expenseList"></div>

  <script>
    // ‚úÖ Firebase config ‡∏Ç‡∏≠‡∏á‡πÅ‡∏õ‡πä‡∏ö
    const firebaseConfig = {
      apiKey: "AIzaSyCKuK-XsRn1kpreS210wqP_uoiwUANQ5r8",
      authDomain: "tb-git.firebaseapp.com",
      projectId: "tb-git",
      storageBucket: "tb-git.firebasestorage.app",
      messagingSenderId: "311209997293",
      appId: "1:311209997293:web:90aaaea62c2a4f80d6ede4",
      measurementId: "G-FSSQZM86HR"
    };

    // ‚úÖ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ‚úÖ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
    function addExpense() {
      const amount = parseInt(document.getElementById("amount").value);
      const category = document.getElementById("category").value;

      if (!amount || !category) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
        return;
      }

      db.collection("expenses").add({
        amount,
        category,
        date: new Date().toISOString()
      }).then(() => {
        alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
        document.getElementById("amount").value = "";
        document.getElementById("category").value = "";
        loadExpenses(); // ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà‡∏´‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
      });
    }

    // ‚úÖ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
    function loadExpenses() {
      db.collection("expenses")
        .orderBy("date", "desc")
        .limit(10)
        .get()
        .then(snapshot => {
          const list = document.getElementById("expenseList");
          list.innerHTML = "";
          snapshot.forEach(doc => {
            const data = doc.data();
            list.innerHTML += `
              <div class="record">
                <strong>${data.amount}‡∏ø</strong> - ${data.category}<br/>
                <small>${new Date(data.date).toLocaleString()}</small>
              </div>
            `;
          });
        });
    }

    // ‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö
    window.onload = loadExpenses;
  </script>
</body>
</html>
