<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Expense Tracker</title>
  <style>
    body { font-family: sans-serif; max-width: 500px; margin: auto; padding: 2rem; }
    input, button { display: block; margin: 10px 0; width: 100%; padding: 10px; }
    .record { border-bottom: 1px solid #ccc; padding: 10px 0; }
  </style>
</head>
<body>
  <h2>üìã ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</h2>
  <input id="amount" type="number" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)" />
  <input id="category" type="text" placeholder="‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏≤‡∏´‡∏≤‡∏£" />
  <button onclick="addExpense()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>

  <h3>üìå ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
  <div id="expenseList"></div>

  <!-- ‚úÖ Firebase v10+ via Module -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import {
      getFirestore,
      collection,
      addDoc,
      getDocs,
      query,
      orderBy,
      limit
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCKuK-XsRn1kpreS210wqP_uoiwUANQ5r8",
      authDomain: "tb-git.firebaseapp.com",
      projectId: "tb-git",
      storageBucket: "tb-git.firebasestorage.app",
      messagingSenderId: "311209997293",
      appId: "1:311209997293:web:90aaaea62c2a4f80d6ede4",
      measurementId: "G-FSSQZM86HR"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢
    window.addExpense = async function () {
      const amount = parseInt(document.getElementById('amount').value);
      const category = document.getElementById('category').value;

      if (!amount || !category) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");

      await addDoc(collection(db, "expenses"), {
        amount,
        category,
        date: new Date().toISOString()
      });

      alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
      document.getElementById("amount").value = "";
      document.getElementById("category").value = "";
      loadExpenses();
    };

    // ‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
    window.loadExpenses = async function () {
      const list = document.getElementById("expenseList");
      list.innerHTML = "";

      const q = query(collection(db, "expenses"), orderBy("date", "desc"), limit(10));
      const querySnapshot = await getDocs(q);
      querySnapshot.forEach((doc) => {
        const data = doc.data();
        list.innerHTML += `
          <div class="record">
            <strong>${data.amount}‡∏ø</strong> - ${data.category}<br>
            <small>${new Date(data.date).toLocaleString()}</small>
          </div>
        `;
      });
    };

    // ‚úÖ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤
    window.onload = loadExpenses;
  </script>
</body>
</html>
