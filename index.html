<!-- ✅ Firebase SDK via CDN -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCKuK-XsRn1kpreS210wqP_uoiwUANQ5r8",
    authDomain: "tb-git.firebaseapp.com",
    projectId: "tb-git",
    storageBucket: "tb-git.firebasestorage.app",
    messagingSenderId: "311209997293",
    appId: "1:311209997293:web:90aaaea62c2a4f80d6ede4",
    measurementId: "G-FSSQZM86HR"
  };

  // ✅ ใช้ CDN ต้องใช้ namespace `firebase` แบบนี้
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  function addExpense() {
    const amount = parseInt(document.getElementById("amount").value);
    const category = document.getElementById("category").value;

    if (!amount || !category) {
      alert("กรุณากรอกให้ครบ");
      return;
    }

    db.collection("expenses").add({
      amount,
      category,
      date: new Date().toISOString()
    }).then(() => {
      alert("บันทึกสำเร็จ");
      document.getElementById("amount").value = "";
      document.getElementById("category").value = "";
      loadExpenses();
    });
  }

  function loadExpenses() {
    db.collection("expenses")
      .orderBy("date", "desc")
      .limit(10)
      .get()
      .then(snapshot => {
        const list = document.getElementById("expenseList");
        list.innerHTML = "";
        snapshot.forEach(doc => {
          const data = doc.data();
          list.innerHTML += `
            <div class="record">
              <strong>${data.amount}฿</strong> - ${data.category}<br/>
              <small>${new Date(data.date).toLocaleString()}</small>
            </div>
          `;
        });
      });
  }

  window.onload = loadExpenses;
</script>
